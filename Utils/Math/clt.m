function CL = clt(signal, config)

dtSqr = (1/config.Fs)^2;
% if(coder.target('matlab'))
%     [b, a] = fir1(config.CLT.filter.order, config.CLT.filter.fc/(config.Fs/2), config.CLT.filter.type);
% else    
%     [b, a] = fir1(100, [5 20]/(1000/2), 'bandpass');
% end

if(config.CLT.filter.order == 100 && all(config.CLT.filter.fc/(config.reqFs/2) == [0.00250000000000000, 0.0100000000000000]))
    b = [0.000904864914120499,0.000944055544957658,0.00100539206842470,0.00109061950370202,0.00120133467094266,0.00133897178858794,0.00150478913925631,0.00169985691009956,0.00192504630532671,0.00218102001963473,0.00246822415161980,0.00278688162594521,0.00313698718218756,0.00351830397695125,0.00393036183411694,0.00437245716606016,0.00484365457643032,0.00534279014271149,0.00586847636438569,0.00641910875018152,0.00699287400570915,0.00758775977084797,0.00820156584465783,0.00883191682441567,0.00947627607472232,0.0101319609325610,0.0107961590447957,0.0114659457259479,0.0121383022162499,0.0128101347130022,0.0134782940422176,0.0141395958324610,0.0147908410487309,0.0154288367412137,0.0160504168617901,0.0166524630003125,0.0172319248929003,0.0177858405558260,0.0183113559009712,0.0188057436923127,0.0192664217074184,0.0196909699734666,0.0200771469538074,0.0204229045685111,0.0207264019406484,0.0209860177691472,0.0212003612389180,0.0213682813894500,0.0214888748741776,0.0215614920545246,0.0215857413845566,0.0215614920545246,0.0214888748741776,0.0213682813894500,0.0212003612389180,0.0209860177691472,0.0207264019406484,0.0204229045685111,0.0200771469538074,0.0196909699734666,0.0192664217074184,0.0188057436923127,0.0183113559009712,0.0177858405558260,0.0172319248929003,0.0166524630003125,0.0160504168617901,0.0154288367412137,0.0147908410487309,0.0141395958324610,0.0134782940422176,0.0128101347130022,0.0121383022162499,0.0114659457259479,0.0107961590447957,0.0101319609325610,0.00947627607472232,0.00883191682441567,0.00820156584465783,0.00758775977084797,0.00699287400570915,0.00641910875018152,0.00586847636438569,0.00534279014271149,0.00484365457643032,0.00437245716606016,0.00393036183411694,0.00351830397695125,0.00313698718218756,0.00278688162594521,0.00246822415161980,0.00218102001963473,0.00192504630532671,0.00169985691009956,0.00150478913925631,0.00133897178858794,0.00120133467094266,0.00109061950370202,0.00100539206842470,0.000944055544957658,0.000904864914120499];
    a = 1;
elseif(config.CLT.filter.order == 100 && all((config.CLT.filter.fc/(config.reqFs/2) - [0.00512295081967213, 0.0204918032786885])<1e-16))
    b = [-0.000810344314602594,-0.000757070334956478,-0.000714996879837530,-0.000679486879430542,-0.000645553897604085,-0.000607927243800082,-0.000561122289451550,-0.000499515117598812,-0.000417420564635109,-0.000309172655454416,-0.000169206388601310,7.86020293460528e-06,0.000227144806332913,0.000493421492100121,0.000811044366220704,0.00118387526434977,0.00161521649923197,0.00210774961666079,0.00266348104606722,0.00328369545008689,0.00396891748421820,0.00471888257413360,0.00553251720567318,0.00640792910249750,0.00734240754037962,0.00833243391683984,0.00937370256200390,0.0104611516429726,0.0115890038814258,0.0127508166744384,0.0139395410833185,0.0151475890364033,0.0163669079807873,0.0175890621164439,0.0188053192555410,0.0200067422712039,0.0211842840346531,0.0223288846884675,0.0234315700674257,0.0244835500575158,0.0254763156785879,0.0264017336868888,0.0272521375202565,0.0280204134507626,0.0287000808665409,0.0292853656757180,0.0297712659098384,0.0301536087008578,0.0304290979133972,0.0305953518310852,0.0306509304209292,0.0305953518310852,0.0304290979133972,0.0301536087008578,0.0297712659098384,0.0292853656757180,0.0287000808665409,0.0280204134507626,0.0272521375202565,0.0264017336868888,0.0254763156785879,0.0244835500575158,0.0234315700674257,0.0223288846884675,0.0211842840346531,0.0200067422712039,0.0188053192555410,0.0175890621164439,0.0163669079807873,0.0151475890364033,0.0139395410833185,0.0127508166744384,0.0115890038814258,0.0104611516429726,0.00937370256200390,0.00833243391683984,0.00734240754037962,0.00640792910249750,0.00553251720567318,0.00471888257413360,0.00396891748421820,0.00328369545008689,0.00266348104606722,0.00210774961666079,0.00161521649923197,0.00118387526434977,0.000811044366220704,0.000493421492100121,0.000227144806332913,7.86020293460528e-06,-0.000169206388601310,-0.000309172655454416,-0.000417420564635109,-0.000499515117598812,-0.000561122289451550,-0.000607927243800082,-0.000645553897604085,-0.000679486879430542,-0.000714996879837530,-0.000757070334956478,-0.000810344314602594];
    a = 1;
else
    %[b, a] = fir1(config.CLT.filter.order, config.CLT.filter.fc/(config.reqFs/2), config.CLT.filter.type);
    error('CLT filter parameters are not supported. Pre-design the filters before you can use them.');
end

y = filtfilt(b,a, signal);

winsize = config.CLT.filter.winsize;

len = length(y);
CL = zeros(1, len);

for i=2+winsize:len
    k = i-winsize:i;
    CL(i) = sum(sqrt(dtSqr + (y(k) - y(k-1)).^2));
end

